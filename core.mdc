---
name: 'Core Rules'
tag: CORE
scope: global
description: 'Always-applied safety, style, and tool usage rules'
alwaysApply: true
---

# Core Rules

These rules apply to EVERY interaction. They are non-negotiable.

## ask_question Tool (STRICT)

**Use `ask_question` for ANY question with discrete options:**

| Situation | Use ask_question |
|-----------|------------------|
| Scope narrowing | "Which file should I focus on?" |
| Implementation choice | "Use approach A, B, or C?" |
| Yes/No confirmation | "Should I proceed with X?" |
| Configuration selection | "Which config option?" |
| Plan alternatives | "Modify plan or execute?" |
| Error resolution | "Fix with option A or B?" |

**NEVER list options A/B/C in prose** - use the tool instead.

**Plain text is OK for:**
- Open-ended clarification (no discrete options)
- Follow-up within conversation flow
- Reporting results (information, not decision)

## Safety (Single Source of Truth)

| Never | Why | Instead |
|-------|-----|---------|
| `git push` | User controls remote | Ask permission, wait |
| `git push --force` | Rewrites history | Never without explicit permission |
| `git commit` (unprompted) | User decides when | Wait for explicit request |
| `rm` user/source files | Data loss risk | `mv` to backup (OK for build artifacts, temp files) |
| `sed` for file edits | Error-prone, no diff | Cursor's file tools |
| `sleep` in commands | Can hang | Explicit timeout or backoff |
| Unbounded scans | Hangs on large repos | Use `head`, scoped paths |
| try/catch in internal code | Hides errors | Propagate; handle only at system boundaries (see #CODE-STYLE) |
| Deep nesting (>4 levels) | Unreadable | Extract to functions |

**Quick mental check:** Push? Commit? Delete? Slow command? â†’ Stop and verify.

## Before ANY Action

1. Check for `CLAUDE.md` in repo root - read current context
2. Check `.specstory/history/` for recent session context
3. Understand existing code patterns before writing

## Response Style

- Be concise and direct
- Show commands before running
- Max 4 indentation levels
- Match existing repo patterns

## Always End With a Question

Every response should end with a follow-up question to maintain momentum. See #ALWAYS for domain-specific examples.

**Default:** "What would you like to do next?"
